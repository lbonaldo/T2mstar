Training dataset size:  640000
Validation dataset size:  160000
================================================================================
Config options:

  N_blocks                 	6
  adam_betas               	(0.9, 0.95)
  add_pad_noise            	0.0001
  add_y_noise              	0.05
  add_z_noise              	0.05
  batch_norm               	False
  batch_size               	1000
  data_path                	/mnt/scratch/bonal1lCMICH/inverse/spline/data
  device                   	cuda
  dropout_perc             	0.2
  exponent_clamping        	2.0
  filename_in              	
  filename_out             	/mnt/scratch/bonal1lCMICH/inverse/spline/results/Jan-27-2022/11-40-01/inn.pt
  final_decay              	0.01
  hidden_layer_sizes       	128
  init_scale               	0.1
  interactive_visualization	False
  l2_weight_reg            	0.01
  lambd_fit_forw           	0.001
  lambd_max_likelihood     	0.001
  lambd_mmd_back           	10.0
  lambd_mmd_forw           	1.0
  lambd_reconstruct        	1.0
  logfile                  	/mnt/scratch/bonal1lCMICH/inverse/spline/results/Jan-27-2022/11-40-01/out.txt
  lr_init                  	0.01
  mmd_back_kernels         	[(0.2, 0.1), (0.2, 0.5), (0.2, 2)]
  mmd_back_weighted        	True
  mmd_forw_kernels         	[(0.2, 2), (1.5, 2), (0.2, 2)]
  n_epochs                 	60
  n_its_per_epoch          	5000
  ndim_pad_x               	0
  ndim_pad_zy              	0
  ndim_x                   	10
  ndim_y                   	5
  ndim_z                   	5
  pre_low_lr               	0
  test_path                	/mnt/scratch/bonal1lCMICH/inverse/spline/results/Jan-27-2022/11-40-01
  test_time_functions      	[]
  train_backward_mmd       	True
  train_forward_mmd        	True
  train_max_likelihood     	True
  train_reconstruction     	True
  use_cuda                 	True
  use_permutation          	False
  verbose_construction     	False
  y_uncertainty_sigma      	0.1
  zeros_noise_scale        	100
================================================================================

Best loss:  inf
New loss:  68.1183496952057
Model saved.
Epoch             L_ML           L_fit       L_mmd_fwd      L_mmd_back       L_reconst      L_ML(test)     L_fit(test) L_mmd_fwd(test) L_mmd_back(test) L_reconst(test)
                                                                                    000    6170151.6448      24645.8299          0.1330          0.0599  26368771881.0662      17297.7744         68.1183          0.1330          0.0600       8112.4036
Best loss:  68.1183496952057
New loss:  2.6435019060969354
Model saved.
                                                                                    001     249475.0501        986.6535          0.1332          0.0599   10688010.4164        682.5896          2.6435          0.1331          0.0599        428.5935
                                                                                    002    5139568.5257      20204.7006          0.1331          0.0594  478380286.7499      41327.2264        152.1532          0.1331          0.0598     110859.8157
                                                                                    003  173322971.5289     693163.0725          0.1331          0.0598  344199500.9439       3102.1411         12.3854          0.1330          0.0600       3109.8356
Best loss:  2.6435019060969354
New loss:  2.3322773814201354
Model saved.
                                                                                    004    1389006.6210       5551.9369          0.1331          0.0599     177813.5074        593.5808          2.3323          0.1330          0.0599         63.1456
                                                                                    005    1598064.5105       6364.0253          0.1332          0.0596      67791.6815     810808.0244       3226.7558          0.1331          0.0595      54774.3774
                                                                                    006    2935273.7579      11709.3466          0.1330          0.0596   37465398.6185   20672172.7199      82065.2187          0.1328          0.0593  201210163244.6535
                                                                                    007    2236133.1483       8916.9647          0.1331          0.0594    2447434.6955      19351.9422         75.7638          0.1328          0.0598       5834.7472
                                                                                    008    1153701.2556       4527.6674          0.1329          0.0598     330230.3652      30840.2306        118.8206          0.1331          0.0599       3105.9563
                                                                                    009    2470300.2339       9792.4676          0.1331          0.0594    7004455.9759      51903.1041        205.7895          0.1327          0.0594      18555.4730
                                                                                    010     200801.7414        799.1656          0.1329          0.0591      37894.9303       1156.3103          4.5814          0.1334          0.0580         66.0041
                                                                                    011    1460415.3747       5784.9799          0.1332          0.0589    2612372.2230      42482.8108        167.4605          0.1335          0.0593       5556.3178
                                                                                    012    1832716.4590       7238.4951          0.1334          0.0578    3631357.9579      65202.9101        259.3932          0.1332          0.0577     113202.6636
                                                                                    013     128166.2778        507.7833          0.1322          0.0550    8831639.5920       3303.6455         13.0428          0.1312          0.0550        643.8143
Best loss:  2.3322773814201354
New loss:  0.13505010595545172
Model saved.
                                                                                    014     217782.5063        860.5620          0.1326          0.0553     145990.3225         34.8783          0.1351          0.1333          0.0545        865.6210
                                                                                    015    1706571.2031       6759.7388          0.1341          0.0539     820222.1385      10973.2698         43.8129          0.1343          0.0534        584.2288
                                                                                    016     160131.3320        630.1099          0.1359          0.0537      71810.0003        364.9514          1.4556          0.1378          0.0515        161.1077
                                                                                    017      25665.3493        100.2484          0.1336          0.0584       7449.3251       2504.0706          9.5377          0.1381          0.0574        889.0418
                                                                                    018    1417808.2178       5610.5473          0.1357          0.0577    2183322.9529      24656.7613         93.0096          0.1351          0.0580       5232.0680
                                                                                    019       2556.9245         10.0996          0.1367          0.0579         17.1531       4543.6595         17.7497          0.1396          0.0575         77.0522
                                                                                    020        143.3254          0.5610          0.1483          0.0546         40.2131        243.9935          0.8112          0.1644          0.0501        360.5038
Best loss:  0.13505010595545172
New loss:  0.039070417082984935
Model saved.
                                                                                    021       1231.4247          3.9186          0.1395          0.0511       7538.6031         13.2346          0.0391          0.1431          0.0510          2.8185
Best loss:  0.039070417082984935
New loss:  0.0012899093395390081
Model saved.
                                                                                    022         56.2298          0.1846          0.1382          0.0511         58.6459          0.4160          0.0013          0.1753          0.0505          2.7267
Best loss:  0.0012899093395390081
New loss:  0.0010407850495539606
Model saved.
                                                                                    023         75.6165          0.2685          0.0838          0.0486          1.1360          0.2874          0.0010          0.0416          0.0492          0.9803
Best loss:  0.0010407850495539606
New loss:  0.0008160696153936442
Model saved.
                                                                                    024          0.2596          0.0010          0.0495          0.0543          0.2907          0.2115          0.0008          0.0427          0.0550          0.0264
                                                                                    025          0.2105          0.0008          0.0433          0.0548          0.0210          0.2118          0.0008          0.0438          0.0549          0.0201
Best loss:  0.0008160696153936442
New loss:  0.000813887624826748
Model saved.
                                                                                    026          0.2110          0.0008          0.0429          0.0550          0.0188          0.2089          0.0008          0.0436          0.0551          0.0195
                                                                                    027          0.2101          0.0008          0.0427          0.0551          0.0185          0.2102          0.0008          0.0431          0.0551          0.0176
Best loss:  0.000813887624826748
New loss:  0.0008094256725598825
Model saved.
                                                                                    028          0.2099          0.0008          0.0429          0.0552          0.0181          0.2093          0.0008          0.0427          0.0552          0.0184
                                                                                    029          0.2098          0.0008          0.0430          0.0551          0.0179          0.2101          0.0008          0.0433          0.0551          0.0177
                                                                                    030          0.2095          0.0008          0.0429          0.0552          0.0179          0.2092          0.0008          0.0430          0.0551          0.0174
                                                                                    031          0.2094          0.0008          0.0429          0.0551          0.0178          0.2092          0.0008          0.0433          0.0552          0.0180
                                                                                    032          0.2094          0.0008          0.0428          0.0551          0.0178          0.2101          0.0008          0.0428          0.0551          0.0173
                                                                                    033          0.2093          0.0008          0.0428          0.0552          0.0178          0.2093          0.0008          0.0434          0.0551          0.0176
                                                                                    034          0.2093          0.0008          0.0428          0.0551          0.0177          0.2105          0.0008          0.0437          0.0551          0.0167
                                                                                    035          0.2091          0.0008          0.0428          0.0551          0.0177          0.2095          0.0008          0.0433          0.0551          0.0174
Best loss:  0.0008094256725598825
New loss:  0.000807826124582789
Model saved.
                                                                                    036          0.2090          0.0008          0.0427          0.0551          0.0177          0.2087          0.0008          0.0427          0.0551          0.0188
                                                                                    037          0.2091          0.0008          0.0428          0.0551          0.0177          0.2098          0.0008          0.0433          0.0551          0.0168
                                                                                    038          0.2091          0.0008          0.0427          0.0551          0.0176          0.2095          0.0008          0.0429          0.0551          0.0170
                                                                                    039          0.2090          0.0008          0.0427          0.0551          0.0176          0.2106          0.0008          0.0431          0.0551          0.0170
                                                                                    040          0.2088          0.0008          0.0427          0.0551          0.0176          0.2084          0.0008          0.0428          0.0552          0.0183
                                                                                    041          0.2087          0.0008          0.0427          0.0551          0.0175          0.2080          0.0008          0.0427          0.0551          0.0175
                                                                                    042          0.2087          0.0008          0.0427          0.0551          0.0175          0.2089          0.0008          0.0429          0.0551          0.0176
                                                                                    043          0.2087          0.0008          0.0427          0.0551          0.0174          0.2086          0.0008          0.0431          0.0551          0.0178
                                                                                    044          0.2085          0.0008          0.0427          0.0551          0.0175          0.2087          0.0008          0.0429          0.0551          0.0170
Best loss:  0.000807826124582789
New loss:  0.0008068485607509501
Model saved.
                                                                                    045          0.2087          0.0008          0.0426          0.0551          0.0174          0.2082          0.0008          0.0430          0.0551          0.0180
                                                                                    046          0.2086          0.0008          0.0427          0.0551          0.0174          0.2084          0.0008          0.0427          0.0551          0.0174
                                                                                    047          0.2085          0.0008          0.0427          0.0551          0.0173          0.2086          0.0008          0.0427          0.0551          0.0177
Best loss:  0.0008068485607509501
New loss:  0.0008066277132456889
Model saved.
                                                                                    048          0.2085          0.0008          0.0427          0.0551          0.0174          0.2079          0.0008          0.0424          0.0551          0.0179
                                                                                    049          0.2084          0.0008          0.0426          0.0551          0.0174          0.2091          0.0008          0.0426          0.0551          0.0176
                                                                                    050          0.2085          0.0008          0.0426          0.0551          0.0174          0.2087          0.0008          0.0427          0.0551          0.0173
                                                                                    051          0.2085          0.0008          0.0427          0.0551          0.0174          0.2093          0.0008          0.0428          0.0551          0.0170
                                                                                    052          0.2086          0.0008          0.0427          0.0551          0.0174          0.2091          0.0008          0.0429          0.0551          0.0170
                                                                                    053          0.2084          0.0008          0.0427          0.0551          0.0173          0.2083          0.0008          0.0429          0.0551          0.0175
                                                                                    054          0.2084          0.0008          0.0426          0.0551          0.0173          0.2085          0.0008          0.0429          0.0551          0.0172
                                                                                    055          0.2083          0.0008          0.0426          0.0551          0.0173          0.2084          0.0008          0.0429          0.0551          0.0174
                                                                                    056          0.2084          0.0008          0.0427          0.0551          0.0174          0.2093          0.0008          0.0427          0.0551          0.0171
Best loss:  0.0008066277132456889
New loss:  0.0008061508811806562
Model saved.
                                                                                    057          0.2083          0.0008          0.0426          0.0551          0.0173          0.2080          0.0008          0.0425          0.0551          0.0175
                                                                                    058          0.2082          0.0008          0.0426          0.0551          0.0173          0.2088          0.0008          0.0428          0.0551          0.0173
                                                                                    059          0.2084          0.0008          0.0426          0.0551          0.0173          0.2086          0.0008          0.0428          0.0551          0.0174


Training took 73.365720 minutes


Test dataset size:  200000
Test results:  0.80599564


Testing took 0.139122 minutes


